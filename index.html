<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <body>
  </body>
  <h2>Escolher uma opção</h2>
  <label for="dropdown">Selecione uma categoria:</label>
  <select id="dropdown">
    <option disabled selected>A carregar opções...</option>
  </select>
  <script>
    async function carregarOpcoes() {
      const apiKey = "9be9a89e6af80cf2e4a4891b2170dd0b";
      const formID = "250995384164063";

      try {
        const response = await fetch(`https://eu-api.jotform.com/form/${formID}/submissions?apiKey=${apiKey}`);
        const data = await response.json();

        const dropdown = document.getElementById("dropdown");
        dropdown.innerHTML = "<option disabled selected>Escolha uma opção...</option>";

        const opcoesUnicas = new Set();

        data.content.forEach(submissao => {
          const resposta = submissao.answers["3"]?.answer;
          if (resposta && !opcoesUnicas.has(resposta)) {
            opcoesUnicas.add(resposta);
            const opt = document.createElement("option");
            opt.value = resposta;
            opt.textContent = resposta;
            dropdown.appendChild(opt);
          }
        });
      } catch (erro) {
        alert("Erro ao carregar opções do dropdown.");
        console.error(erro);
      }
    }

    function aplicarCSSPersonalizado(css) {
      const style = document.createElement("style");
      style.innerHTML = css;
      document.head.appendChild(style);
    }

    window.addEventListener("message", function (e) {
      if (e.data.type === "ready") {
        const customCSS = window.properties.customCSS || "";
        aplicarCSSPersonalizado(customCSS);
        carregarOpcoes();
      }
    });
  </script>
</head>
</html>
